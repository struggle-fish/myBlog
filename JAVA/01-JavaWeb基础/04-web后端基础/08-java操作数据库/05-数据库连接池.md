# 数据库连接池


## 介绍
mybatis中，使用了数据库连接池技术，避免频繁的创建连接、销毁连接而带来的资源浪费。



1). 没有数据库连接池的情况



![LOGO](/public/image/javapublic/ba3a7b2e-9b08-4b3d-9efe-af53470908b6.png)

客户端执行SQL语句：
要先创建一个新的连接对象，然后执行SQL语句，
SQL语句执行后又需要关闭连接对象从而释放资源，
每次执行SQL时都需要创建连接、销毁链接，
这种频繁的重复创建销毁的过程是比较耗费计算机的性能。

2). 有数据库连接池的情况

![LOGO](/public/image/javapublic/d1b93c85-b70d-4055-bfc9-c463a9e548eb.png)


数据库连接池是个容器，负责分配、管理数据库连接(Connection)
程序在启动时，会在数据库连接池(容器)中，创建一定数量的Connection对象

允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个
客户端在执行SQL时，先从连接池中获取一个Connection对象，然后在执行SQL语句，
SQL语句执行完之后，释放Connection时就会把Connection对象归还给连接池（Connection对象可以复用）

释放空闲时间超过最大空闲时间的连接，来避免因为没有释放连接而引起的数据库连接遗漏
客户端获取到Connection对象了，但是Connection对象并没有去访问数据库(处于空闲)，
`数据库连接池发现Connection对象的空闲时间 > 连接池中预设的最大空闲时间`，
此时数据库连接池就会自动释放掉这个连接对象


数据库连接池的好处：
- 资源重用
- 提升系统响应速度
- 避免数据库连接遗漏


























## 使用

要怎么样实现数据库连接池呢？
官方(sun)提供了数据库连接池标准（`javax.sql.DataSource`接口）

```java 
public Connection getConnection() throws SQLException;
```

第三方组织必须按照DataSource接口实现


现在使用更多的是：Hikari、Druid  （性能更优越）



1). Hikari（追光者） [默认的连接池] 


![LOGO](/public/image/javapublic/207e3ba1-d0b5-402b-a852-5879d60483aa.png)


2). Druid（德鲁伊）

- Druid连接池是阿里巴巴开源的数据库连接池项目
- 功能强大，性能优秀，是Java语言最好的数据库连接池之一



1). 在`pom.xml`文件中引入依赖

```xml 
<dependency>
    <!-- Druid连接池依赖 -->
    <groupId>com.alibaba</groupId>
    <artifactId>druid-spring-boot-starter</artifactId>
    <version>1.2.19</version>
</dependency>
```


2). 在`application.properties`中引入数据库连接配置


```java 
spring.datasource.type=com.alibaba.druid.pool.DruidDataSource
spring.datasource.druid.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.druid.url=jdbc:mysql://localhost:3306/web
spring.datasource.druid.username=root
spring.datasource.druid.password=1234

```

![LOGO](/public/image/javapublic/2e099d16-6c61-4c8d-87c7-cf6b770fedcb.png)












