# å¸¸ç”¨æ³¨è§£

## `@Resource`

### åŸºæœ¬åŠŸèƒ½
`@Resource` æ³¨è§£ç”¨äº`ä¾èµ–æ³¨å…¥`ï¼Œè®© `Spring` è‡ªåŠ¨å°†éœ€è¦çš„å¯¹è±¡æ³¨å…¥åˆ°å­—æ®µä¸­ã€‚

`@Resource` å‘Šè¯‰ `Spring`ï¼šè¿™ä¸ªå­—æ®µéœ€è¦è‡ªåŠ¨æ³¨å…¥ä¸€ä¸ªå¯¹è±¡ã€‚

ç®€å•æ¥è¯´ï¼š`@Resource = "Springï¼Œè¯·è‡ªåŠ¨ç»™æˆ‘è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä¸éœ€è¦è‡ªå·±åˆ›å»º"`ã€‚


### å·¥ä½œåŸç†


::: code-group

```java [ç‰‡æ®µ]

@Controller
@RequestMapping("/xxx")
public class AccountAuditController extends BaseController {
    @Resource
    private ConfigProperties configProperties;
    // èƒ½çœ‹å‡ºæ¥ configProperties æ˜¯ AccountAuditController ç±»çš„å±æ€§å—
    // configProperties é€šè¿‡ Springçš„ä¾èµ–æ³¨å…¥åŠŸèƒ½, 
    // è‡ªåŠ¨æ³¨å…¥äº†ä¸€ä¸ª ConfigProperties ç±»å‹çš„å¯¹è±¡
}
```

```java [å®ä¾‹1]
@Controller
@RequestMapping("/xxx")
public class AccountAuditController {
    
    @Resource  // ğŸ‘ˆ å‘Šè¯‰ Springï¼šè¯·è‡ªåŠ¨æ³¨å…¥è¿™ä¸ªå¯¹è±¡
    private ConfigProperties configProperties;
    
    @Resource  // ğŸ‘ˆ å‘Šè¯‰ Springï¼šè¯·è‡ªåŠ¨æ³¨å…¥è¿™ä¸ªå¯¹è±¡
    private IDealerAuthService dealerAuthService;
    
    public void someMethod() {
        // ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡
        String cookieName = configProperties.getCookieName();// âœ… å¯ä»¥ç›´æ¥ç”¨
        dealerAuthService.getLoginUser(cookie);  // âœ… å¯ä»¥ç›´æ¥ç”¨
    }
}
```
:::


`Spring`ï¼Œè¯·è‡ªåŠ¨ç»™æˆ‘æ³¨å…¥ä¸€ä¸ª `ConfigProperties` ç±»å‹çš„å¯¹è±¡
æ³¨å…¥åï¼Œæˆ‘å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ `configProperties` è¿™ä¸ªå˜é‡äº†.

`configProperties`æ˜¯ç±»çš„å±æ€§,åªä¸è¿‡å®ƒåˆæ˜¯ `ConfigProperties`ç±»çš„å®ä¾‹


å¦‚æœæ²¡æœ‰ `@Resource `ä¼šæ€æ ·ï¼Ÿ

:::code-group
```java [æ²¡æœ‰ @Resource çš„æƒ…å†µ]

// âŒ æ²¡æœ‰ @Resource çš„æƒ…å†µ
private ConfigProperties configProperties;// è¿™ä¸ªå˜é‡æ˜¯ null

public void someMethod() {
    configProperties.getCookieName(); // âŒ ä¼šæŠ¥ NullPointerException
}

```

```java[ä¸ä½¿ç”¨ @Resourceï¼ˆæ‰‹åŠ¨åˆ›å»ºï¼‰]

public class AccountAuditController {
    private ConfigProperties configProperties;
    
    public AccountAuditController() {
        // éœ€è¦æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡
        configProperties = new ConfigProperties();
        // è¿˜éœ€è¦æ‰‹åŠ¨è®¾ç½®å„ç§å±æ€§...
    }
}
```

```java[ä½¿ç”¨ @Resourceï¼ˆè‡ªåŠ¨æ³¨å…¥ï¼‰]
public class AccountAuditController {
    @Resource
    private ConfigProperties configProperties;// Spring è‡ªåŠ¨æ³¨å…¥ï¼Œç›´æ¥å¯ç”¨
}

```
:::

## `@Controller`

`@Controller` æ˜¯ `Spring MVC `çš„æ³¨è§£ï¼Œç”¨äºæ ‡è®°æ§åˆ¶å™¨ç±»ï¼Œå¤„ç† `HTTP` è¯·æ±‚ã€‚

`@Controller` å‘Šè¯‰ `Spring`ï¼šè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç”¨äºå¤„ç† Web è¯·æ±‚ã€‚


::: code-group
```java[ç¤ºä¾‹]
@Controller // ğŸ‘ˆ æ ‡è®°è¿™æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ç±»
@RequestMapping("/accountaudit")  // å®šä¹‰è¯·æ±‚è·¯å¾„å‰ç¼€
public class AccountAuditController extends BaseController {
    
    @GetMapping("/queryCounts")// å¤„ç† GET è¯·æ±‚
    @ResponseBody
    public Protocol queryCounts(Integer dealerId) {
        // ...
    }
    
    @PostMapping("/querySales")// å¤„ç† POST è¯·æ±‚
    @ResponseBody
    public Protocol querySales(@RequestBody DealerSalesQuery in) {
        // ...
    }
}

```
:::

### ä¸»è¦ä½œç”¨

- æ ‡è®°ä¸ºæ§åˆ¶å™¨

`Spring` ä¼šè¯†åˆ«è¿™ä¸ªç±»å¹¶æ³¨å†Œä¸ºæ§åˆ¶å™¨
å¯ä»¥å¤„ç† `HTTP` è¯·æ±‚ï¼ˆ`GETã€POSTã€PUTã€DELETE` ç­‰ï¼‰

- é…åˆ `@RequestMapping` ä½¿ç”¨

```java
@Controller
@RequestMapping("/accountaudit")// æ‰€æœ‰æ–¹æ³•çš„è·¯å¾„å‰ç¼€
public class AccountAuditController {
    
    @GetMapping("/queryCounts") // å®Œæ•´è·¯å¾„ï¼š/accountaudit/queryCounts
    public Protocol queryCounts() { ... }
    
    @PostMapping("/querySales") // å®Œæ•´è·¯å¾„ï¼š/accountaudit/querySales
    public Protocol querySales() { ... }
}

```


- å¯ä»¥è¿”å›è§†å›¾æˆ–æ•°æ®


```java
@Controller
public class AccountAuditController {
    // è¿”å›è§†å›¾ï¼ˆHTMLé¡µé¢ï¼‰
    @RequestMapping("/login")
    public ModelAndView toLoginPage() {
        return new ModelAndView("account/audit/login");// è¿”å›è§†å›¾
    }
    
    // è¿”å›æ•°æ®ï¼ˆJSONï¼‰
    @PostMapping("/queryCounts")
    @ResponseBody // ğŸ‘ˆ åŠ ä¸Šè¿™ä¸ªæ³¨è§£ï¼Œè¿”å› JSON æ•°æ®è€Œä¸æ˜¯è§†å›¾
    public Protocol queryCounts() {
        return new Protocol(...);  // è¿”å›æ•°æ®
    }
}
```

### å·¥ä½œæµç¨‹

```java
å®¢æˆ·ç«¯è¯·æ±‚
    â†“
http://æœåŠ¡å™¨/accountaudit/queryCounts?dealerId=123
    â†“
Spring MVC è·¯ç”±
    â†“
æ‰¾åˆ° @Controller æ ‡è®°çš„ AccountAuditController
    â†“
åŒ¹é… @GetMapping("/queryCounts") æ–¹æ³•
    â†“
æ‰§è¡Œæ–¹æ³•é€»è¾‘
    â†“
è¿”å›ç»“æœï¼ˆè§†å›¾æˆ–æ•°æ®ï¼‰
```

### å®Œæ•´å®ä¾‹

```java
@Controller // ğŸ‘ˆ 1. æ ‡è®°ä¸ºæ§åˆ¶å™¨
@RequestMapping("/accountaudit")// ğŸ‘ˆ 2. å®šä¹‰è·¯å¾„å‰ç¼€
public class AccountAuditController {
    
    @Resource // ğŸ‘ˆ 3. è‡ªåŠ¨æ³¨å…¥ä¾èµ–
    private ConfigProperties configProperties;
    
    @GetMapping("/queryCounts")// ğŸ‘ˆ 4. å¤„ç† GET è¯·æ±‚
    @ResponseBody   // ğŸ‘ˆ 5. è¿”å› JSON æ•°æ®
    public Protocol queryCounts(Integer dealerId) {
        // å¤„ç†ä¸šåŠ¡é€»è¾‘
        return accountAuditService.queryDealerSalesStateCount(in);
    }
    
    @RequestMapping("/login")// ğŸ‘ˆ 6. å¤„ç†è¯·æ±‚ï¼Œè¿”å›è§†å›¾
    public ModelAndView toLoginPage() {
        return new ModelAndView("account/audit/login");// è¿”å› HTML é¡µé¢
    }
}
```














## HTTPè¯·æ±‚æ³¨è§£


### `@RequestMapping`

é€šç”¨è¯·æ±‚æ˜ å°„æ³¨è§£,å¯å¤„ç†æ‰€æœ‰ `HTTP` æ–¹æ³•ï¼ˆ`GETã€POSTã€PUTã€DELETE` ç­‰ï¼‰
æœ€çµæ´»ï¼Œä½†éœ€è¦æŒ‡å®šæ–¹æ³•ç±»å‹


### `@GetMapping`

ä¸“é—¨å¤„ç† GET è¯·æ±‚
æ˜¯ `@RequestMapping(method = RequestMethod.GET)` çš„ç®€åŒ–å†™æ³•

### `@PostMapping`

ä¸“é—¨å¤„ç† POST è¯·æ±‚
æ˜¯ `@RequestMapping(method = RequestMethod.POST)` çš„ç®€åŒ–å†™æ³•


### ä½¿ç”¨ç¤ºä¾‹

::: code-group
```java[@RequestMapping]

@Controller
@RequestMapping("/accountaudit") âœ… ç±»çº§åˆ«çš„è·¯å¾„å®šä¹‰ æ‰€æœ‰æ–¹æ³•çš„è·¯å¾„å‰ç¼€
public class AccountAuditController {
    
    // æ–¹å¼1ï¼šå¤„ç†æ‰€æœ‰ HTTP æ–¹æ³•
    @RequestMapping("/login")
    public ModelAndView login() {
        return new ModelAndView("account/audit/login");
    }
    
    // æ–¹å¼2ï¼šåªå¤„ç† GET è¯·æ±‚
    // å®Œæ•´è·¯å¾„ï¼š/accountaudit/queryCounts
    @RequestMapping(value = "/queryCounts", method = RequestMethod.GET)
    public Protocol queryCounts() {
        // ...
    }
    
    // æ–¹å¼3ï¼šåªå¤„ç† POST è¯·æ±‚
    @RequestMapping(value = "/querySales", method = RequestMethod.POST)
    public Protocol querySales() {
        // ...
    }
    
    // æ–¹å¼4ï¼šå¤„ç†å¤šä¸ª HTTP æ–¹æ³•
    @RequestMapping(value = "/update", method = {RequestMethod.PUT, RequestMethod.POST})
    public Protocol update() {
        // ...
    }
}



```

```java [@GetMapping]
@Controller
@RequestMapping("/accountaudit")
public class AccountAuditController {
    
    // ç®€æ´å†™æ³•ï¼šåªå¤„ç† GET è¯·æ±‚
    @GetMapping("/queryCounts")
    @ResponseBody
    public Protocol queryCounts(Integer dealerId) {
        // æŸ¥è¯¢æ•°æ®
        return accountAuditService.queryDealerSalesStateCount(in);
    }
    
    // è·å–é¡µé¢
    @GetMapping("/login")
    public ModelAndView toLoginPage() {
        return new ModelAndView("account/audit/login");
    }
}

```

```java [@PostMapping]

@Controller
@RequestMapping("/accountaudit")
public class AccountAuditController {
    
    // ç®€æ´å†™æ³•ï¼šåªå¤„ç† POST è¯·æ±‚
    @PostMapping("/querySales")
    @ResponseBody
    public Protocol querySales(@RequestBody DealerSalesQuery in) {
        // æäº¤æ•°æ®
        return accountAuditService.queryDealerSales(in);
    }
    
    @PostMapping("/sendActiveSms")
    @ResponseBody
    public Protocol sendActiveSms(@RequestBody ActiveSalesSmsIn info) {
        // æäº¤æ•°æ®
        return accountAuditService.sendActiveSms(info);
    }
}

```
:::










